# Top-level grammar for Singapore Law texts

Based on Act 6A of PDPA.

Files:

- Analyse.hs  -- Haskell file for generating the grammar
- Top.cf      -- (obsolete) the generated grammar, with manual modifications at the end
- Law.gf      -- abstract syntax converted from Top.cf
- LawEng.gf   -- abstract syntax converted from Top.cf
- Law.hs      -- abstract syntax as Haskell GADT (generated by make)
- LawParser.hs -- script for parsing and analysing lines of text
- Makefile     -- generating PGF and GADT
- Semantics.hs -- conversion of AST to a logic and logic to spreadsheets
- Spreadsheet.hs -- a simple recursive spreadsheet data structure
- VisualizeLaw.hs -- script for parsing and conversion to spreasheet (as TSV)
- act-6A.html -- the original document
- act-6A.txt  -- the original as plain text
- annotated-6A.txt -- the origina annotated with categories and keywords
- lines-6A.txt  -- the original separated by empty lines (for UD)
- tokenized-6A.txt -- the original tokenized so that it can be parsed


Processing:
- build pgf: `gf --make LawEng.gf`
- build pgf and gadt: `make`
- parse text: `runghc LawParser.hs <tokenized-6A.txt`
- tsv generation test: `cat tokenized-6A.txt | runghc VisualizeLaw.hs`
- by changing the definition of `ifDebug` in `VisualizeLaw.hs` (by a
  simple comment/comment), the run also produces debugging
  information, as well as a `lawtrees.dot`, which shows abstract
  syntax trees graphically
- in that case, `dot -Tpng -O lawtrees.dot >lawtrees.png` creates
  graphical trees for each line

Older processing:

- generate a BNF grammar: `runghc Analyse.hs >GenTop.cf` (no longer needed)
- parse in GF:
```
> i GenTop.cf
> rf -file="tokenized-6A.txt" -lines | p -cat=Line
```

## Alternative: use stack

If you don't have a global GHC, you can also run this with stack. In that case, follow these steps:

* `stack build` to build both executables

#### Processing:
- build pgfâ€”**identical to previous instruction**: `gf --make LawEng.gf`
- parse text: `stack run LawParser <tokenized-6A.txt`
- tsv generation test: `cat tokenized-6A.txt | head -8 | stack run VisualizeLaw`

#### Older processing:
- generate the grammar: `stack run Analyses > GenTop.cf` (no longer needed)
